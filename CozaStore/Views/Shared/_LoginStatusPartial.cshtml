@using CozaStore.Interfaces
@using Microsoft.AspNetCore.Identity

@inject UserManager<AppUser> UserManager
@inject IUnitOfWork _unitOfWork

<style>
    .dropdown-toggle, .dropdown-item {
        cursor: pointer;
    }
</style>

@if (User.Identity.IsAuthenticated)
{
    var user = await UserManager.GetUserAsync(User);
    var shoppingCarts = await _unitOfWork.ShoppingCartRepository.GetAllAsync(user.Id);
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" asp-controller="cart" asp-action="index">
                <div class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti js-show-cart" data-notify="@shoppingCarts.Count()">
                    <i class="zmdi zmdi-shopping-cart"></i>
                </div>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link">
                <i class="fa-solid fa-bell fa-lg"></i>
            </a>
        </li>
       
        <li class="nav-item mx-2" style="min-width: 150px;">
            <div class="d-flex gap-1 align-items-center">
                <img src="@user.Image"
                     alt="picture user" class="rounded-circle" style="max-width: 30px;
        border: 2px solid white;
        display: inline;">
                <div class="dropdown">
                    <div class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        @user.FullName
                    </div>

                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Edit profile</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#">SLogout</a></li>
                    </ul>
                </div>
            </div>
        </li>
        
    </ul>
    

}
else
{
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link">
                <i class="fa-solid fa-cart-shopping fa-lg"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link">
                <i class="fa-solid fa-bell fa-lg"></i>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" asp-controller="account" asp-action="login">
                <i class="fa-solid fa-user fa-lg"></i>
            </a>
        </li>
    </ul>
}

